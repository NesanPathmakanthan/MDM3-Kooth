import pandas as pd
import numpy as np
from datetime import datetime, timedelta

# Parameters
n_users = 500
n_content = 1000
topics = ["Anxiety", "LGBTQ+", "Neurodiversity","Depression"]
content_types = ["Article", "Forum", "Article Comment", "Forum Comment"]

# Generate synthetic data
np.random.seed(42)
data = {
    "Content_Created_ID": np.arange(1, n_content + 1),
    "Created_Timestamp": [datetime(2024, 9, 1) + timedelta(hours=np.random.randint(0, 720)) for _ in range(n_content)],
    "Service_User_ID": np.random.choice([f"SU{i}" for i in range(1, n_users + 1)], n_content),
    "Content_Topic": np.random.choice(topics, n_content, p=[0.3, 0.2, 0.2, 0.3]),
    "Content_Type": np.random.choice(content_types, n_content, p=[0.5, 0.3, 0.1, 0.1]),
    "Views": np.random.poisson(20, n_content),
    "Comments": np.random.poisson(5, n_content),
}

# Add Moderated_Timestamp with delays
data["Moderated_Timestamp"] = [
    ts + timedelta(hours=np.random.randint(1, 48)) for ts in data["Created_Timestamp"]
]

# Create Ancestor Content IDs for comments
data["Ancestor_Content_ID"] = [
    np.random.choice(data["Content_Created_ID"][:i]) if (ct in ["Article Comment", "Forum Comment"] and i > 0) else None
    for i, ct in enumerate(data["Content_Type"])
]

# Create DataFrame
df = pd.DataFrame(data)


file_path = "/Users/isobelbridge/Documents/mdm4/simulated_kooth_data.csv"
df.to_csv(file_path, index=False)

print(f"File saved to: {file_path}")
